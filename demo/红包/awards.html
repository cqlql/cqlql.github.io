<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title></title>
    <meta charset="UTF-8">
    <meta content="width=device-width,initial-scale=1.0,user-scalable=no" name="viewport" />
    <script>
        var androidQQ = 'gFoHYbFOxil3ZofvaK3QHppsEtzBBkUj',
            iPhoneQQ = '493288890,b465519973b535f2f6043f580366cf28d293844d3377649da4ceb7ec93be6c92';
    </script>

    <style>
        body {
            margin: 0;
            font-size: 18px;
            background: #fff885;
        }

        p {
            padding: 0;
            margin: 0;
        }

        h2 {
            margin: 0;
            font-size: 20px;
            font-weight: normal;
        }

        table {
            width: 100%;
        }

        th {
            text-align: left;
            font-weight: normal;
            color: #fff;
            padding: 4px 10px;
        }

        td,
        .awards-page strong,
        .awards-page a {
            color: #ff3e3e;
        }

        dl dt {
            float: left;
            color: #fff;
            background: #ffc71e;
            border-radius: 50%;
            font-size: 12px;
            width: 16px;
            height: 16px;
            text-align: center;
            margin: 2px 0 0 8px;
            line-height: 16px;
        }

        dl dd {
            overflow: hidden;
            margin-left: 30px;
        }

        .awards-page .list {
            background: #55c4c8 url(imgs/light-ray-2.png) no-repeat;
            background-size: 100% auto;
        }
        .awards-page .list h2 {
        color: #fff;
        padding: 8px 10px 4px;

        }
        .awards-page .list .decorate {
            height: 22px;
            position: relative;
            overflow: hidden;
        }

        .awards-page .list .decorate img {
            width: 21px;
            position: absolute;
        }

        .awards-page .list .decorate .bg {
            height: 14px;
            background: url(imgs/decorate.png);
            background-size: 25px auto;
            position: absolute;
            bottom: 0;
            width: 100%;
        }

        .awards-page .list .win {
            overflow:hidden;
            height:160px;
        }
        
        
        .awards-page .detail {
            overflow: hidden;
            background: #fff885;
        }

        .awards-page .block1 {
            border: 3px dotted #8dcfc4;
            background: #fffcd2;
            margin: 42px 12px 40px;
        }

        .awards-page .block1 h2 {
            height: 38px;
            text-align: center;
            margin-top: -22px;
        }

        .awards-page .block1 h2 span {
            display: inline-block;
            height: 38px;
            background: #70d2ff;
            vertical-align: middle;
            color: #fff;
            line-height: 36px;
            padding: 0 18px;
        }

        .awards-page .block1 h2::before,
        .awards-page .block1 h2::after {
            content: '';
            display: inline-block;
            width: 17px;
            height: 38px;
            background: url(imgs/h-bg.png) no-repeat 0 0;
            background-size: 151px auto;
            vertical-align: middle;
        }

        .awards-page .block1 h2:after {
            background-position: right 0;
        }
    </style>
</head>
<body>
    <div class="awards-page">
        <div class="list">
            <h2>获奖名单</h2>
            <div class="win">
                <table>
                    <tbody>
                        <tr>
                            <th style="color:red">数据获取中...</th>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="decorate">
                <img src="imgs/red-packet.png" style="left:6%;top:4px" />
                <img src="imgs/red-packet.png" style="left:14%" />
                <img src="imgs/red-packet.png" style="right:4%;top:3px" />
                <img src="imgs/red-packet.png" style="right:12%" />
                <img src="imgs/red-packet.png" style="right:20%;top:3px" />
                <div class="bg"></div>
            </div>
        </div>
        <div class="detail">
            <div class="block1">
                <h2><span>抢红包步骤</span></h2>
                <dl>
                    <dt>1</dt>
                    <dd>
                        <a href="javascript:goqq('3269064212');">立即加入QQ群开始抢红包吧!</a>
                    </dd>
                </dl>
                <dl>
                    <dt>2</dt>
                    <dd>
                        小π老师每晚21:00发布红包,面值<strong>100</strong>—<strong>10000</strong>随机发布，分享的人越多，红包越大哦
                    </dd>
                </dl>
            </div>
        </div>
    </div>
    <script>

       

        var c = {};

        c.each = function (arr, fn) {
            for (var i = 0, len = arr.length; i < len; i++) {
                if (fn(i, arr[i], len) === false) {
                    break;
                }
            }
        };

        c.deviceName = function () {
            var names = ['Android', 'iPhone'],
                userAgent = window.navigator.userAgent,
                deviceName = '';


            c.each(names, function (i, n) {

                if (userAgent.indexOf(n) > -1) {
                    deviceName = n;
                    return false;
                }

            });

            return deviceName;

        }();

        c.ajax = function (params) {

            function onReadystatechange() {
                if (xhr.readyState === 4) {

                    if (xhr.status === 200) {
                        success(xhr.responseText);
                    }
                    else {
                        error(xhr, xhr.status, arguments);
                    }

                    complete();
                }
            }

            var
                url = params.url,
                type = params.type || 'get',
                success = params.success || function () { },
                error = params.error || function () { },
                complete = params.complete || function () { },

                xhr = new XMLHttpRequest();

            xhr.addEventListener('readystatechange', onReadystatechange, false);

            xhr.open(type, url);

            xhr.send();

            return xhr;
        };

        var goqq = function () {

            if (c.deviceName === 'Android') {
                if (jsqq.joinQQGroup) {
                    return function () {
                        jsqq.joinQQGroup(androidQQ);
                    };
                }
                else {
                    return function (num) {
                        jsqq.goQq(num);
                    };
                }

            }
            else if (c.deviceName === 'iPhone') {
                if (location.search.toLowerCase().indexOf('qqgroup') > -1) {
                    return function () {
                        location.href = 'goqq:' + iPhoneQQ;
                    };
                }
                else {
                    return function (num) {
                        location.href = 'goqq:' + num;
                    };
                }
            }
        }();

        listShow();

        // 自动滚动效果
        function scrollAnime() {
            var
               eShowWin = document.querySelector('.win')
                , winHeight = eShowWin.children[0].clientHeight

                , duration
                , eStyle;

            if (winHeight <= 160) {
                return;
            }

            // 每秒滚动20px。计算需要多少秒
            duration = (winHeight / 20).toFixed(2);

            eStyle = document.createElement('style');

            eStyle.innerHTML ='.awards-page .list .win table {\
-webkit-animation-name:a;\
animation-name:a;\
-webkit-animation-duration:' + duration + 's;\
animation-duration:' + duration + 's;\
-webkit-animation-timing-function:linear;\
animation-timing-function:linear;\
-webkit-animation-iteration-count:infinite;\
animation-iteration-count:infinite;\
-webkit-animation-direction:normal;\
animation-direction:normal;\
}\
@keyframes a{0%{\
transform:translate3d(0,0,0);}100%{\
transform:translate3d(0,-' + winHeight + 'px,0);}}\
@-webkit-keyframes a{0%{\
-webkit-transform:translate3d(0,0,0);\
-webkit-transform:translate3d(0,-' + winHeight + 'px,0);}}';

            eShowWin.innerHTML += eShowWin.innerHTML;

            document.body.appendChild(eStyle);
        }

        // 红包用户列表
        function listShow() {
            var eContBox = document.querySelector('tbody');
            c.ajax({
                url: '/event/awards.json',
                success: function (d) {
                    var html = '';

                    d = JSON.parse(d);
                    
                    if (d && d.length) {
                        d.forEach(function (n) {
                            html += '<tr><th>' + n.info + '</th><td>' + n.money + '</td></tr>';
                        });
                        eContBox.innerHTML = html;
                        scrollAnime();
                    }
                    else {
                        eContBox.innerHTML = '<tr><th style="color:red">数据获取失败</th></tr>';
                    }
                }
            });
        }

    </script>
</body>

</html>
