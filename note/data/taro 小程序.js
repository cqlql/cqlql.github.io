window['cb_taro 小程序']({"outline":[{"id":"3490140638","level":1,"name":"场景值","children":[{"id":"1418342598","level":2,"name":"页面获取","children":[]},{"id":"2547200099","level":2,"name":"相关文档","children":[]}]},{"id":"2700752614","level":1,"name":"富文本","children":[]},{"id":"1721611022","level":1,"name":"生命周期&amp;页面钩子","children":[{"id":"2999149218","level":2,"name":"onShow","children":[{"id":"2316322606","level":3,"name":"script setup 用法","children":[{"id":"2567138143","level":4,"name":"新方式 - Vue3 Composition APIs","children":[]},{"id":"2362532474","level":4,"name":"旧方式","children":[]}]}]},{"id":"2872960763","level":2,"name":"onShareAppMessage","children":[{"id":"8360694","level":3,"name":"script setup 用法","children":[]}]},{"id":"1814708466","level":2,"name":"相关文档","children":[]}]},{"id":"3558797071","level":1,"name":"问题","children":[{"id":"702220505","level":2,"name":"环境问题：安装卡在 node-pre-gyp install --fallback-to-build","children":[]}]},{"id":"3209802655","level":1,"name":"页面传值","children":[{"id":"506071046","level":2,"name":"url 方式","children":[]},{"id":"3678752611","level":2,"name":"events 方式","children":[]},{"id":"2858557001","level":2,"name":"注意事项","children":[]}]}],"content":"<section><h1 id=\"3490140638\">场景值</h1><section><h2 id=\"1418342598\">页面获取</h2><pre><code class=\"language-ts\"><span class=\"hljs-keyword\">import</span> type { RouterInfo } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@tarojs/taro'</span>\n<span class=\"hljs-keyword\">import</span> { eventCenter, getCurrentInstance } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@tarojs/taro'</span>\neventCenter.on(<span class=\"hljs-function\">(<span class=\"hljs-params\">getCurrentInstance(</span>).<span class=\"hljs-params\">router</span> <span class=\"hljs-params\">as</span> <span class=\"hljs-params\">RouterInfo</span>).<span class=\"hljs-params\">onShow</span>, <span class=\"hljs-params\">()</span> =&gt;</span> {\n  <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">'onshow'</span>, wx.getLaunchOptionsSync())\n})</code></pre>\n</section><section><h2 id=\"2547200099\">相关文档</h2><p><a href=\"https://developers.weixin.qq.com/miniprogram/dev/api/base/app/life-cycle/wx.getLaunchOptionsSync.html\">https://developers.weixin.qq.com/miniprogram/dev/api/base/app/life-cycle/wx.getLaunchOptionsSync.html</a></p>\n<p><a href=\"https://developers.weixin.qq.com/miniprogram/dev/reference/scene-list.html\">https://developers.weixin.qq.com/miniprogram/dev/reference/scene-list.html</a></p>\n</section></section><section><h1 id=\"2700752614\">富文本</h1><p>渲染富文本</p>\n<p><a href=\"https://nervjs.github.io/taro/docs/components/base/rich-text\">https://nervjs.github.io/taro/docs/components/base/rich-text</a></p>\n</section><section><h1 id=\"1721611022\">生命周期&amp;页面钩子</h1><section><h2 id=\"2999149218\">onShow</h2><section><h3 id=\"2316322606\">script setup 用法</h3><section><h4 id=\"2567138143\">新方式 - Vue3 Composition APIs</h4><p><a href=\"https://taro-docs.jd.com/taro/docs/composition-api#usedidshow\">usedidshow 文档</a></p>\n<pre><code class=\"language-ts\"><span class=\"hljs-keyword\">import</span> { useDidShow } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@tarojs/taro'</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  setup() {\n    useDidShow(<span class=\"hljs-function\"><span class=\"hljs-params\">()</span> =&gt;</span> <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">'onShow'</span>))\n  },\n}</code></pre>\n</section><section><h4 id=\"2362532474\">旧方式</h4><p><a href=\"https://taro-docs.jd.com/taro/docs/vue-page#onshow-\">onshow 文档</a></p>\n<pre><code class=\"language-ts\"><span class=\"hljs-keyword\">import</span> { eventCenter, getCurrentInstance, RouterInfo } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@tarojs/taro'</span>\neventCenter.on(<span class=\"hljs-function\">(<span class=\"hljs-params\">getCurrentInstance(</span>).<span class=\"hljs-params\">router</span> <span class=\"hljs-params\">as</span> <span class=\"hljs-params\">RouterInfo</span>).<span class=\"hljs-params\">onShow</span>, <span class=\"hljs-params\">()</span> =&gt;</span> {\n  <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">'onshow'</span>)\n})</code></pre>\n</section></section></section><section><h2 id=\"2872960763\">onShareAppMessage</h2><section><h3 id=\"8360694\">script setup 用法</h3><p><a href=\"https://taro-docs.jd.com/taro/docs/composition-api#useshareappmessage\">useshareappmessage 文档</a></p>\n<p><strong>使用时，必须为页面配置 <code>enableShareAppMessage: true</code></strong></p>\n<pre><code class=\"language-ts\"><span class=\"hljs-keyword\">import</span> { useShareAppMessage } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@tarojs/taro'</span>\nuseShareAppMessage(<span class=\"hljs-function\">(<span class=\"hljs-params\">res</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (res.from === <span class=\"hljs-string\">'button'</span>) {\n    <span class=\"hljs-comment\">// 来自页面内转发按钮</span>\n    <span class=\"hljs-built_in\">console</span>.log(res.target)\n  }\n  <span class=\"hljs-keyword\">return</span> {\n    <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">'自定义转发标题'</span>,\n    <span class=\"hljs-attr\">path</span>: <span class=\"hljs-string\">'/page/user?id=123'</span>,\n  }\n})</code></pre>\n</section></section><section><h2 id=\"1814708466\">相关文档</h2></section></section><section><h1 id=\"3558797071\">问题</h1><section><h2 id=\"702220505\">环境问题：安装卡在 node-pre-gyp install --fallback-to-build</h2><p>先安装 <code>npm --build-from-source install --no-save bcrypt nodejieba</code></p>\n</section></section><section><h1 id=\"3209802655\">页面传值</h1><section><h2 id=\"506071046\">url 方式</h2><pre><code class=\"language-ts\"><span class=\"hljs-comment\">// 父页面</span>\nTaro.navigateTo({\n  <span class=\"hljs-attr\">url</span>: <span class=\"hljs-string\">`/pages/goods-details/index?id=<span class=\"hljs-subst\">${item.id}</span>`</span>,\n})\n\n<span class=\"hljs-comment\">// 子页面</span>\n<span class=\"hljs-keyword\">import</span> { getCurrentInstance, RouterInfo } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'@tarojs/taro'</span>\n<span class=\"hljs-keyword\">let</span> id = (getCurrentInstance().router <span class=\"hljs-keyword\">as</span> RouterInfo).params.id</code></pre>\n</section><section><h2 id=\"3678752611\">events 方式</h2><pre><code class=\"language-js\"><span class=\"hljs-comment\">// 父页面</span>\n\nTaro.navigateTo({\n  <span class=\"hljs-attr\">url</span>: <span class=\"hljs-string\">'test'</span>,\n  <span class=\"hljs-attr\">events</span>: {\n    <span class=\"hljs-comment\">// 接收子页面的传值</span>\n    acceptDataFromOpenedPage: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">data</span>) </span>{\n      <span class=\"hljs-built_in\">console</span>.log(data)\n    },\n    <span class=\"hljs-attr\">someEvent</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">data</span>) </span>{\n      <span class=\"hljs-built_in\">console</span>.log(data)\n    },\n  },\n  <span class=\"hljs-attr\">success</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">res</span>) </span>{\n    <span class=\"hljs-comment\">// 向子页面传值</span>\n    res.eventChannel.emit(<span class=\"hljs-string\">'acceptDataFromOpenerPage'</span>, { <span class=\"hljs-attr\">data</span>: <span class=\"hljs-string\">'test3'</span> })\n  },\n})</code></pre>\n<pre><code class=\"language-js\"><span class=\"hljs-comment\">// 子页面</span>\n\n<span class=\"hljs-keyword\">const</span> pages = getCurrentPages()\n<span class=\"hljs-keyword\">const</span> currentPage = pages[pages.length - <span class=\"hljs-number\">1</span>] <span class=\"hljs-comment\">// 当前子页面</span>\n<span class=\"hljs-keyword\">const</span> eventChannel = currentPage.getOpenerEventChannel()\n\n<span class=\"hljs-comment\">// 向父页面传值</span>\neventChannel.emit(<span class=\"hljs-string\">'acceptDataFromOpenedPage'</span>, { <span class=\"hljs-attr\">data</span>: <span class=\"hljs-string\">'传给父页面的值'</span> })\n\n<span class=\"hljs-comment\">// 接收父页面的传值</span>\neventChannel.on(<span class=\"hljs-string\">'acceptDataFromOpenerPage'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">data</span>) </span>{\n  <span class=\"hljs-built_in\">console</span>.log(data)\n})</code></pre>\n</section><section><h2 id=\"2858557001\">注意事项</h2><p>redirectTo 无法传值，navigateTo 可以</p>\n"})