window['cb_dotnet-c#']({"outline":[{"id":"2229339172","level":1,"name":"dotnet-c","children":[{"id":"3848581178","level":2,"name":".net 截图方案","children":[]},{"id":"633913226","level":2,"name":"Selenium 方式","children":[]},{"id":"1181888274","level":2,"name":"PuppeteerSharp 方式","children":[]}]}],"content":"<section><h1 id=\"2229339172\">dotnet-c</h1><section><h2 id=\"3848581178\">.net 截图方案</h2><p>相关文章 <a href=\"https://www.jianshu.com/p/aec4b1216011\">Headless Chrome入门</a></p>\n</section><section><h2 id=\"633913226\">Selenium 方式</h2><p>支持 .Net framework 4.5 </p>\n<pre><code class=\"language-csharp\">using OpenQA.Selenium;\nusing OpenQA.Selenium.Chrome;\n\n<span class=\"hljs-keyword\">var</span> options = <span class=\"hljs-keyword\">new</span> ChromeOptions();\noptions.AddArgument(<span class=\"hljs-string\">\"--headless\"</span>);\noptions.AddArgument(<span class=\"hljs-string\">\"--window-size=1080,1920\"</span>);\n<span class=\"hljs-comment\">//options.AddArguments(new List&lt;string&gt;() { \"headless\", \"screensho\", \"window-size=1080,1920\" });</span>\n<span class=\"hljs-comment\">// var chrome = new ChromeDriver(Path.GetDirectoryName(Assembly.GetEntryAssembly().Location), options);</span>\n<span class=\"hljs-keyword\">var</span> chrome = <span class=\"hljs-keyword\">new</span> ChromeDriver(options);\nchrome.Url = @<span class=\"hljs-string\">\"http://192.168.1.222:8081/?id=asd\"</span>;\nITakesScreenshot screenshotDriver = chrome <span class=\"hljs-keyword\">as</span> ITakesScreenshot;\nScreenshot screenshot = screenshotDriver.GetScreenshot();\nscreenshot.SaveAsFile(<span class=\"hljs-string\">\"./test.png\"</span>);\nchrome.Quit();</code></pre>\n</section><section><h2 id=\"1181888274\">PuppeteerSharp 方式</h2><p>只支持 .Net framework 4.6+</p>\n<pre><code class=\"language-csharp\"><span class=\"hljs-keyword\">await</span> <span class=\"hljs-keyword\">new</span> BrowserFetcher().DownloadAsync(BrowserFetcher.DefaultRevision);\n\n<span class=\"hljs-keyword\">var</span> url = <span class=\"hljs-string\">\"http://192.168.1.222:8081/?id=asd\"</span>;\n<span class=\"hljs-keyword\">var</span> file = <span class=\"hljs-string\">\".\\\\somepage.jpg\"</span>;\n\n<span class=\"hljs-keyword\">var</span> launchOptions = <span class=\"hljs-keyword\">new</span> LaunchOptions()\n{\n    Headless = <span class=\"hljs-literal\">true</span>\n};\n\nusing (<span class=\"hljs-keyword\">var</span> browser = <span class=\"hljs-keyword\">await</span> Puppeteer.LaunchAsync(launchOptions))\n    <span class=\"hljs-comment\">//await Page.SetViewport(new ViewPortOptions { Width = 50, Height = 50 });</span>\nusing (<span class=\"hljs-keyword\">var</span> page = <span class=\"hljs-keyword\">await</span> browser.NewPageAsync())\n{\n    <span class=\"hljs-keyword\">await</span> page.SetViewportAsync(<span class=\"hljs-keyword\">new</span> ViewPortOptions { Width = <span class=\"hljs-number\">1080</span>, Height = <span class=\"hljs-number\">1920</span> });\n    <span class=\"hljs-keyword\">await</span> page.GoToAsync(url);\n    <span class=\"hljs-keyword\">await</span> page.ScreenshotAsync(file);\n}</code></pre>\n"})