window['cb_nodejs-express']({"outline":[{"id":"782060005","level":1,"name":"文件上传","children":[]},{"id":"2127800210","level":1,"name":"路由 post 参数获取","children":[]}],"content":"<section><h1 id=\"782060005\">文件上传</h1><p><a href=\"https://www.npmjs.com/package/multer\">multer 文档</a></p>\n<p>此处为单文件上传，一次性多次文件待探索</p>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'express'</span>)\n<span class=\"hljs-keyword\">var</span> router = express.Router()\n<span class=\"hljs-keyword\">var</span> multer = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'multer'</span>)\n<span class=\"hljs-keyword\">var</span> upload = multer({ <span class=\"hljs-attr\">dest</span>: <span class=\"hljs-string\">'e:/uploads/'</span> })\n\n<span class=\"hljs-comment\">// upload.single('avatar') 这个 avatar 对应 input 的 name 值，如：&lt;input name=\"avatar\" type=\"file\"/&gt;。否则报错</span>\nrouter.post(<span class=\"hljs-string\">'/file'</span>, upload.single(<span class=\"hljs-string\">'file'</span>), <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) </span>{\n  res.send({\n    <span class=\"hljs-string\">'status'</span>: <span class=\"hljs-number\">200</span>,\n    <span class=\"hljs-string\">'message'</span>: <span class=\"hljs-string\">'ok'</span>,\n    <span class=\"hljs-string\">'result'</span>: {}\n  })\n})\n\n<span class=\"hljs-built_in\">module</span>.exports = router\n</code></pre>\n</section><section><h1 id=\"2127800210\">路由 post 参数获取</h1><p><a href=\"http://www.expressjs.com.cn/4x/api.html#req.body\">req.body 说明 - express4 api 中文手册</a></p>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'express'</span>)();\n<span class=\"hljs-keyword\">var</span> bodyParser = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'body-parser'</span>);\n<span class=\"hljs-keyword\">var</span> multer = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'multer'</span>);\n\napp.use(bodyParser.json()); <span class=\"hljs-comment\">// for parsing application/json</span>\napp.use(bodyParser.urlencoded({ <span class=\"hljs-attr\">extended</span>: <span class=\"hljs-literal\">true</span> })); <span class=\"hljs-comment\">// for parsing application/x-www-form-urlencoded</span>\napp.use(multer()); <span class=\"hljs-comment\">// for parsing multipart/form-data</span>\n\napp.post(<span class=\"hljs-string\">'/'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) </span>{\n  <span class=\"hljs-built_in\">console</span>.log(req.body); <span class=\"hljs-comment\">// 获取</span>\n  res.json(req.body);\n})</code></pre>\n"})