window['cb_c#']({"outline":[{"id":"3789880452","level":1,"name":".net 截图方案","children":[{"id":"1062400353","level":2,"name":"Selenium 方式","children":[]},{"id":"744331311","level":2,"name":"PuppeteerSharp 方式","children":[]},{"id":"258176857","level":2,"name":"CefSharp.OffScreen","children":[]}]},{"id":"2846942992","level":1,"name":"Console 控制台程序","children":[]}],"content":"<section><h1 id=\"3789880452\">.net 截图方案</h1><p>相关文章 <a href=\"https://www.jianshu.com/p/aec4b1216011\">Headless Chrome入门</a></p>\n<section><h2 id=\"1062400353\">Selenium 方式</h2><p>Selenium 一般用于单元测试，所以不推荐</p>\n<p>支持 .Net framework 4.5 </p>\n<pre><code class=\"language-csharp\">using OpenQA.Selenium;\nusing OpenQA.Selenium.Chrome;\n\n<span class=\"hljs-keyword\">var</span> options = <span class=\"hljs-keyword\">new</span> ChromeOptions();\noptions.AddArgument(<span class=\"hljs-string\">\"--headless\"</span>);\noptions.AddArgument(<span class=\"hljs-string\">\"--window-size=1080,1920\"</span>);\n<span class=\"hljs-comment\">//options.AddArguments(new List&lt;string&gt;() { \"headless\", \"screensho\", \"window-size=1080,1920\" });</span>\n<span class=\"hljs-comment\">// var chrome = new ChromeDriver(Path.GetDirectoryName(Assembly.GetEntryAssembly().Location), options);</span>\n<span class=\"hljs-keyword\">var</span> chrome = <span class=\"hljs-keyword\">new</span> ChromeDriver(options);\nchrome.Url = @<span class=\"hljs-string\">\"http://192.168.1.222:8081/?id=asd\"</span>;\nITakesScreenshot screenshotDriver = chrome <span class=\"hljs-keyword\">as</span> ITakesScreenshot;\nScreenshot screenshot = screenshotDriver.GetScreenshot();\nscreenshot.SaveAsFile(<span class=\"hljs-string\">\"./test.png\"</span>);\nchrome.Quit();</code></pre>\n</section><section><h2 id=\"744331311\">PuppeteerSharp 方式</h2><p>只支持 .Net framework 4.6+</p>\n<pre><code class=\"language-csharp\"><span class=\"hljs-keyword\">await</span> <span class=\"hljs-keyword\">new</span> BrowserFetcher().DownloadAsync(BrowserFetcher.DefaultRevision);\n\n<span class=\"hljs-keyword\">var</span> url = <span class=\"hljs-string\">\"http://192.168.1.222:8081/?id=asd\"</span>;\n<span class=\"hljs-keyword\">var</span> file = <span class=\"hljs-string\">\".\\\\somepage.jpg\"</span>;\n\n<span class=\"hljs-keyword\">var</span> launchOptions = <span class=\"hljs-keyword\">new</span> LaunchOptions()\n{\n    Headless = <span class=\"hljs-literal\">true</span>\n};\n\nusing (<span class=\"hljs-keyword\">var</span> browser = <span class=\"hljs-keyword\">await</span> Puppeteer.LaunchAsync(launchOptions))\n    <span class=\"hljs-comment\">//await Page.SetViewport(new ViewPortOptions { Width = 50, Height = 50 });</span>\nusing (<span class=\"hljs-keyword\">var</span> page = <span class=\"hljs-keyword\">await</span> browser.NewPageAsync())\n{\n    <span class=\"hljs-keyword\">await</span> page.SetViewportAsync(<span class=\"hljs-keyword\">new</span> ViewPortOptions { Width = <span class=\"hljs-number\">1080</span>, Height = <span class=\"hljs-number\">1920</span> });\n    <span class=\"hljs-keyword\">await</span> page.GoToAsync(url);\n    <span class=\"hljs-keyword\">await</span> page.ScreenshotAsync(file);\n}</code></pre>\n</section><section><h2 id=\"258176857\">CefSharp.OffScreen</h2><p><a href=\"https://www.nuget.org/packages/CefSharp.OffScreen/\">https://www.nuget.org/packages/CefSharp.OffScreen/</a></p>\n<p><a href=\"https://github.com/cefsharp/CefSharp/blob/master/CefSharp.OffScreen.Example/Program.cs\">https://github.com/cefsharp/CefSharp/blob/master/CefSharp.OffScreen.Example/Program.cs</a></p>\n<p><a href=\"https://www.cnblogs.com/guxin/p/wpf-embed-html-by-cefsharp.html\">https://www.cnblogs.com/guxin/p/wpf-embed-html-by-cefsharp.html</a>\n<a href=\"https://www.cnblogs.com/Lulus/p/8274701.html\">https://www.cnblogs.com/Lulus/p/8274701.html</a></p>\n</section></section><section><h1 id=\"2846942992\">Console 控制台程序</h1><pre><code class=\"language-c#\"><span class=\"hljs-comment\">// 等待任意键关闭</span>\nConsole.ReadKey()</code></pre>\n"})